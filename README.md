# dmesg-human-openwrt

> –°–∫—Ä–∏–ø—Ç –¥–ª—è OpenWrt, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤—ã–≤–æ–¥ `dmesg` –≤ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–í OpenWrt –∫–æ–º–∞–Ω–¥–∞ `dmesg` –∏–∑ BusyBox –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–ª—é—á `-T` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤ —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ. –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –ø—Ä–µ–æ–±—Ä–∞–∑—É—è –≤—Ä–µ–º—è –∏–∑ —Å–µ–∫—É–Ω–¥ —Å –º–æ–º–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã –≤ –ø—Ä–∏–≤—ã—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏.

### –î–æ
```
[18772654.532021] br-lan: port 1(lan1) entered disabled state
```

### –ü–æ—Å–ª–µ
```
[2025-10-02 14:25:54] br-lan: port 1(lan1) entered disabled state
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –°–ø–æ—Å–æ–± 1: –ü—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å–∫—Ä–∏–ø—Ç–∞ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ:
```sh
nano /root/dmesg_human.sh
```

2. –í—Å—Ç–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:
```sh
#!/bin/sh
# –ü–µ—Ä–µ–≤–æ–¥ –≤—Ä–µ–º–µ–Ω–∏ dmesg –≤ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è –¥–ª—è OpenWrt (BusyBox)

# –ú–æ–º–µ–Ω—Ç –∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã (UNIX timestamp)
BOOT_TIME=$(date -d "$(uptime -s)" +%s)

dmesg | while read -r line; do
    # –ò–∑–≤–ª–µ–∫–∞–µ–º —Å–µ–∫—É–Ω–¥—ã –∏–∑ —Å–∫–æ–±–æ–∫ [12345.678]
    SEC=$(echo "$line" | sed -n 's/^\[\([0-9]\+\)\..*/\1/p')
    
    if [ -n "$SEC" ]; then
        EVENT_TIME=$((BOOT_TIME + SEC))
        HUMAN=$(date -d "@$EVENT_TIME" +"%Y-%m-%d %H:%M:%S")
        echo "[$HUMAN] ${line#*]}"
    else
        echo "$line"
    fi
done
```

3. –°–¥–µ–ª–∞–π—Ç–µ —Ñ–∞–π–ª –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:
```sh
chmod +x /root/dmesg_human.sh
```

### –°–ø–æ—Å–æ–± 2: –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ wget/curl

```sh
wget -O /root/dmesg_human.sh https://raw.githubusercontent.com/–≤–∞—à-username/dmesg-human-openwrt/main/dmesg_human.sh
chmod +x /root/dmesg_human.sh
```

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ª–æ–≥–∏ —Å —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–º –≤—Ä–µ–º–µ–Ω–µ–º
```sh
/root/dmesg_human.sh
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É
```sh
/root/dmesg_human.sh | grep lan1
```

### –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å—Ç—Ä–æ–∫
```sh
/root/dmesg_human.sh | tail -n 50
```

### –ü–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
```sh
/root/dmesg_human.sh | grep -E "lan1|wifi|usb"
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∞–ª–∏–∞—Å–∞ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞

–î–æ–±–∞–≤—å—Ç–µ –≤ `/etc/profile` –∏–ª–∏ `~/.profile`:
```sh
alias dmesg-human='/root/dmesg_human.sh'
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ:
```sh
dmesg-human
```

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **OpenWrt** (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ –≤–µ—Ä—Å–∏—è—Ö —Å BusyBox v1.36.1)
- –ö–æ–º–∞–Ω–¥–∞ `date` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π `-d @timestamp` (–ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Å–±–æ—Ä–∫–µ OpenWrt)
- –ö–æ–º–∞–Ω–¥–∞ `uptime` —Å –∫–ª—é—á–æ–º `-s`

## üîß –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞:
- OpenWrt 24.10.0
- BusyBox v1.36.1

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã (`uptime -s`) –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏–π
- –¢–æ—á–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ
- –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω NTP
